# PDFImager

PDFファイルを **1ページごとに画像化して保存する** Windows 向け簡易GUIアプリです。  
直感的な操作でPDFの各ページをPNGまたはJPEG画像に変換できます。

---

## 目次

- [概要](#概要)
- [主な機能](#主な機能)
- [スクリーンショット（UI構成）](#スクリーンショットui構成)
- [動作要件](#動作要件)
- [セットアップ手順](#セットアップ手順)
- [使い方](#使い方)
- [出力ファイルについて](#出力ファイルについて)
- [オプション詳細](#オプション詳細)
- [トラブルシューティング](#トラブルシューティング)
- [ライセンス](#ライセンス)

---

## 概要

| 項目         | 内容                                          |
| ------------ | --------------------------------------------- |
| アプリ名     | PDFImager                                     |
| 用途         | PDFの各ページを画像ファイルとして書き出す      |
| 対応OS       | Windows 10 / 11（Python 3.10 以上）           |
| GUIフレームワーク | tkinter（Python 標準ライブラリ）          |
| PDF処理      | PyMuPDF (fitz)                                |

---

## 主な機能

- **PDF → 画像変換** — PDFの全ページを個別の画像ファイルとして出力
- **出力形式の選択** — PNG / JPEG から選べる
- **DPI（解像度）指定** — 72〜600 DPI の範囲で自由に設定（デフォルト: 200）
- **進捗のリアルタイム表示** — プログレスバーとログで変換状況を確認
- **UIフリーズなし** — バックグラウンドスレッドで変換処理を実行

---

## スクリーンショット（UI構成）

アプリ起動後のウィンドウは以下の構成です：

```
┌─────────────────────────────────────────────┐
│  PDFImager                                  │
├─ PDFファイル ────────────────────────────────┤
│  [ ファイルパス入力欄          ] [参照…]     │
├─ 出力先フォルダ ─────────────────────────────┤
│  [ フォルダパス入力欄          ] [参照…]     │
├─ オプション ─────────────────────────────────┤
│  DPI: [200 ▲▼]    形式: [PNG ▼]            │
├──────────────────────────────────────────────┤
│  [███████████████████░░░░░░░] プログレスバー │
│  変換中… 5/10                                │
│ ┌──────────────────────────────────────────┐ │
│ │ ログ表示エリア                           │ │
│ │  [1/10] sample_page0001.png              │ │
│ │  [2/10] sample_page0002.png              │ │
│ └──────────────────────────────────────────┘ │
│              [ 変換開始 ]                    │
└──────────────────────────────────────────────┘
```

---

## 動作要件

| 要件             | 詳細                                        |
| ---------------- | ------------------------------------------- |
| **OS**           | Windows 10 / 11                             |
| **Python**       | 3.10 以上（3.12 推奨）                      |
| **必須パッケージ** | PyMuPDF（`pip install PyMuPDF`）          |
| **標準ライブラリ** | tkinter, os, sys, threading（追加インストール不要） |

> **Note:** tkinter は Python の標準ライブラリに含まれていますが、  
> Linux 等では別途インストールが必要な場合があります（本アプリは Windows 向けです）。

---

## セットアップ手順

### 1. リポジトリの取得

```bash
cd F:\Tools\PDFImager
```

### 2. 仮想環境の作成（推奨）

```bash
python -m venv .venv
.venv\Scripts\activate
```

### 3. 依存パッケージのインストール

```bash
pip install PyMuPDF
```

### 4. インストール確認

```bash
python -c "import fitz; print('PyMuPDF version:', fitz.__version__)"
```

バージョン番号が表示されればセットアップ完了です。

---

## 使い方

### アプリの起動

```bash
python pdf_imager.py
```

仮想環境を使用している場合：

```bash
.venv\Scripts\python.exe pdf_imager.py
```

### 操作手順

| ステップ | 操作                                                                 |
| :------: | -------------------------------------------------------------------- |
|  **1**   | **PDFファイルを選択** — 「参照…」ボタンをクリックし、変換したいPDFファイルを選択します。 |
|  **2**   | **出力先フォルダを指定** — 画像の保存先フォルダを選択します。未指定の場合はPDFと同じフォルダが自動設定されます。 |
|  **3**   | **オプションを設定**（任意） — DPI（解像度）と出力画像形式（PNG/JPEG）を必要に応じて変更します。 |
|  **4**   | **「変換開始」をクリック** — 変換処理が開始されます。進捗はプログレスバーとログに表示されます。 |
|  **5**   | **完了を確認** — 全ページの変換が終わると完了ダイアログが表示されます。 |

---

## 出力ファイルについて

### ファイル命名規則

```
<PDFファイル名>_page<ページ番号(4桁ゼロ埋め)>.<拡張子>
```

### 具体例

入力ファイル: `報告書2026.pdf`（全10ページ）、形式: PNG の場合

```
報告書2026_page0001.png
報告書2026_page0002.png
報告書2026_page0003.png
  …
報告書2026_page0010.png
```

JPEG を選択した場合は拡張子が `.jpg` になります。

### 出力先

- 出力先フォルダを明示的に指定しなかった場合、**PDFファイルと同じフォルダ** に保存されます。
- 指定したフォルダが存在しない場合は **自動的に作成** されます。

---

## オプション詳細

### DPI（解像度）

| 設定値 | 用途の目安                         | ファイルサイズ |
| :----: | ---------------------------------- | :------------: |
|   72   | 画面プレビュー用（低画質）         |     小         |
|  150   | Web掲載・メール添付向け            |     中         |
|  200   | **デフォルト** — 一般用途に最適    |     中〜大     |
|  300   | 印刷用（高画質）                   |     大         |
|  600   | 高精細印刷・拡大利用（最高画質）   |     特大       |

- 設定範囲: **72 〜 600**（50刻みで調整可能）
- DPIが高いほど高画質ですが、**ファイルサイズも大きく**なり、**変換時間も長く**なります。

### 画像形式

| 形式     | 拡張子 | 特徴                                           |
| -------- | :----: | ---------------------------------------------- |
| **PNG**  | `.png` | 可逆圧縮。透過対応。文字・図表がクリアに出力される。 |
| **JPEG** | `.jpg` | 非可逆圧縮。ファイルサイズが小さい。写真向き。      |

---

## トラブルシューティング

### Q. `ModuleNotFoundError: No module named 'fitz'` と表示される

**A.** PyMuPDF がインストールされていません。以下を実行してください：

```bash
pip install PyMuPDF
```

仮想環境を使用している場合は、仮想環境を有効にしてからインストールしてください。

### Q. PDFを選択しても変換が始まらない

**A.** 以下を確認してください：

- PDFファイルが破損していないか
- PDFファイルのパスに特殊文字が含まれていないか
- 出力先フォルダへの書き込み権限があるか

### Q. 変換後の画像がぼやけている

**A.** DPI設定を上げてください。印刷品質が必要な場合は **300 DPI** 以上を推奨します。

### Q. 変換に時間がかかる

**A.** 以下の要因で処理時間が長くなります：

- ページ数が多い
- DPI設定が高い（特に 600 DPI）
- PDFに高解像度の画像が多く含まれている

DPIを下げることで処理時間を短縮できます。

### Q. `tkinter` が見つからない

**A.** Windows標準のPython（python.org からダウンロード）にはtkinterが含まれています。  
Microsoft Store版Pythonの場合はtkinterが含まれないことがあります。  
Python公式サイトからインストーラー版を使用してください。

---

## ファイル構成

```
PDFImager/
├── pdf_imager.py    … メインアプリケーション
├── README.md        … 本ドキュメント
└── .venv/           … Python仮想環境（セットアップ後に生成）
```

---

## ライセンス

本ツールは自由に利用・改変できます。  
依存ライブラリ [PyMuPDF](https://pymupdf.readthedocs.io/) は AGPL-3.0 ライセンスです。  
商用利用の場合は PyMuPDF の商用ライセンスをご確認ください。
